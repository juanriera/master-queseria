<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Caso 1. Análisis de una fabricación de queso camembert usando Python y Google Colab. – Análisis de datos industriales usando Excel y Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./090-indice_dataframes.html" rel="next">
<link href="./070-estad-simple.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./080-caso1-camembert.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Caso 1. Análisis de una fabricación de queso camembert usando <code>Python</code> y Google Colab.</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis de datos industriales usando Excel y Python</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción general</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./020-estad-entorno.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">La estadística en el entorno industrial.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./030-herramientas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Herramientas para el análisis. La reproducibilidad.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./040-organizacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La organización de los datos y el flujo de trabajo.Los datos ordenados o <em>arreglados</em> (<em>tidy data</em>)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050-intro-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introducción a Python en el entorno Google Colab</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./060-exploracion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">La exploración de los datos mediante gráficos.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./070-estad-simple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Medidas centrales y medidas de dispersión: la media y la varianza.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./080-caso1-camembert.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Caso 1. Análisis de una fabricación de queso camembert usando <code>Python</code> y Google Colab.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./090-indice_dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Indice de DataFrames utilizados</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Anexos</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./150-media-centro-gravedad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La media aritmética como centro de gravedad de un grupo de datos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./160-bibliografia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#flujo-de-trabajo" id="toc-flujo-de-trabajo" class="nav-link active" data-scroll-target="#flujo-de-trabajo"><span class="header-section-number">8.1</span> Flujo de trabajo</a>
  <ul class="collapse">
  <li><a href="#importar-los-datos" id="toc-importar-los-datos" class="nav-link" data-scroll-target="#importar-los-datos">1. Importar los datos</a></li>
  <li><a href="#ordenarlimpiar-los-datos" id="toc-ordenarlimpiar-los-datos" class="nav-link" data-scroll-target="#ordenarlimpiar-los-datos">2. Ordenar/limpiar los datos</a></li>
  <li><a href="#visualizar-análisis-gráfico" id="toc-visualizar-análisis-gráfico" class="nav-link" data-scroll-target="#visualizar-análisis-gráfico">3. Visualizar: Análisis gráfico</a></li>
  <li><a href="#comunicar-discusión-de-la-información-en-equipo." id="toc-comunicar-discusión-de-la-información-en-equipo." class="nav-link" data-scroll-target="#comunicar-discusión-de-la-información-en-equipo.">4. Comunicar: discusión de la información en equipo.</a></li>
  </ul></li>
  <li><a href="#resumen-del-capítulo" id="toc-resumen-del-capítulo" class="nav-link" data-scroll-target="#resumen-del-capítulo"><span class="header-section-number">8.2</span> Resumen del capítulo</a></li>
  <li><a href="#ejercicios-propuestos" id="toc-ejercicios-propuestos" class="nav-link" data-scroll-target="#ejercicios-propuestos"><span class="header-section-number">8.3</span> Ejercicios propuestos</a>
  <ul class="collapse">
  <li><a href="#ejercicio-1" id="toc-ejercicio-1" class="nav-link" data-scroll-target="#ejercicio-1">Ejercicio 1</a></li>
  <li><a href="#ejercicio-2-avanzado" id="toc-ejercicio-2-avanzado" class="nav-link" data-scroll-target="#ejercicio-2-avanzado">Ejercicio 2 (avanzado)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Caso 1. Análisis de una fabricación de queso camembert usando <code>Python</code> y Google Colab.</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>En este ejercicio usaremos un fichero o archivo de datos en formato CSV que habremos exportado previamente desde nuestra hoja de cálculo. Más adelante aprenderemos cómo leer directamente los datos de nuestras hojas Excel.</p>
<p><a href="https://colab.research.google.com/github/juanriera/master-queseria/blob/master/040-caso1-camembert.ipynb">Abrir este cuaderno en Google Colab</a></p>
<p><a href="https://raw.githubusercontent.com/juanriera/master-queseria/master/datos/camembert.csv">Descargar los datos de ejemplo <code>camembert.csv</code> usados en este cuaderno</a></p>
<section id="flujo-de-trabajo" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="flujo-de-trabajo"><span class="header-section-number">8.1</span> Flujo de trabajo</h2>
<p>Coo vimos en el capítulo 2, es muy conveniente establecer un flujo de trabajo regular, de forma que cada etapa del análisis sea un paso que se apoye en los anteriores.</p>
<p>Este flujo de trabajo debe cubrir las etapas que veíamos en ese capítulo:</p>
<p><img src="01-imagenes/data-science-explore.svg" class="img-fluid"></p>
<p>Vamos a ir desarrollando este flujo paso a paso.</p>
<section id="importar-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="importar-los-datos">1. Importar los datos</h3>
<p>En este cuaderno vamos a cargar los datos desde GitHub; estos datos pueden ser descargados en el ordenador o Google Drive de cada uno, junto con el cuaderno, en los enlaces facilitados al principio. Una vez en Drive, puede leerse la tabla mediante el método que vimos al final del capítulo anterior.</p>
<div id="cell-7" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>url_datos <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/juanriera/master-queseria/master/datos/camembert.csv'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(url_datos, decimal <span class="op">=</span> <span class="st">","</span>, sep<span class="op">=</span><span class="st">';'</span>, encoding<span class="op">=</span><span class="st">'ISO-8859-1'</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"¡Archivo "</span>, url_datos,<span class="st">" cargado correctamente!"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Dimensiones de los datos: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error al cargar el archivo: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>¡Archivo  https://raw.githubusercontent.com/juanriera/master-queseria/master/datos/camembert.csv  cargado correctamente!
Dimensiones de los datos: (211, 7)</code></pre>
</div>
</div>
<p>Vemos el <code>dataframe</code> que hemos leído, mediante la funcion <code>.head()</code>, que nos muestra las cinco primeras lineas.</p>
<div id="cell-9" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;elapsed&quot;:32,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1759679742595,&quot;user&quot;:{&quot;displayName&quot;:&quot;Juan Riera&quot;,&quot;userId&quot;:&quot;13936244033390161607&quot;},&quot;user_tz&quot;:-120}}" data-outputid="8110245b-21b1-451c-ce92-6bfeca09356d" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fecha</th>
<th data-quarto-table-cell-role="th">fabricacion</th>
<th data-quarto-table-cell-role="th">est</th>
<th data-quarto-table-cell-role="th">mg</th>
<th data-quarto-table-cell-role="th">ph</th>
<th data-quarto-table-cell-role="th">cloruros</th>
<th data-quarto-table-cell-role="th">coliformes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>11/01/2020</td>
<td>1</td>
<td>46.68</td>
<td>24.0</td>
<td>4.85</td>
<td>1.50</td>
<td>80.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>12/01/2020</td>
<td>1</td>
<td>48.09</td>
<td>25.0</td>
<td>4.67</td>
<td>1.61</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>13/01/2020</td>
<td>1</td>
<td>45.97</td>
<td>24.0</td>
<td>4.71</td>
<td>1.48</td>
<td>9200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>14/01/2020</td>
<td>1</td>
<td>46.24</td>
<td>23.5</td>
<td>4.78</td>
<td>1.69</td>
<td>20.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>15/01/2020</td>
<td>1</td>
<td>45.81</td>
<td>23.0</td>
<td>4.77</td>
<td>1.56</td>
<td>150.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Verificamos la estructura interna de nuestro <code>dataframe</code> y el tipo de los datos (entero, numérico, carácter…) mediante la función <code>.info()</code></p>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;elapsed&quot;:25,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1759679744124,&quot;user&quot;:{&quot;displayName&quot;:&quot;Juan Riera&quot;,&quot;userId&quot;:&quot;13936244033390161607&quot;},&quot;user_tz&quot;:-120}}" data-outputid="8d6f8d1f-dd64-4ad5-b8c0-68fba50e6b92" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 211 entries, 0 to 210
Data columns (total 7 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   fecha        211 non-null    object 
 1   fabricacion  211 non-null    int64  
 2   est          211 non-null    float64
 3   mg           211 non-null    float64
 4   ph           211 non-null    float64
 5   cloruros     211 non-null    float64
 6   coliformes   210 non-null    float64
dtypes: float64(5), int64(1), object(1)
memory usage: 11.7+ KB</code></pre>
</div>
</div>
<p>Como resultado de la importación el <code>csv</code>, la <code>fecha</code> aparece como columna <code>object</code>, que es un tipo genérico de datos que incluye el tipo <code>character</code>, que es en realidad como <code>python</code>considera esta columna; nos interesa convertirla en un formato de fecha que <code>pandas</code> pueda reconocer.</p>
<div id="cell-13" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fecha'</span>] <span class="op">=</span> pd.to_datetime(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'fecha'</span>], </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y'</span>,  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    errors<span class="op">=</span><span class="st">'coerce'</span> <span class="co"># Si hay una fecha inválida, la convierte a 'NaT' (Not a Time) en lugar de fallar.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Recuerda que si no comprendes bien el código, puedes copiarlo y pegarlo en Google Gemini y pedir a Gemini una explicación detallada de lo que hace. Puedes también preguntar a Gemini que te explique bien la función <code>.to_datetime()</code> con los diferentes formatos de conversión de fechas.</p>
</blockquote>
<p>Verificamos la conversión:</p>
<div id="cell-15" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 211 entries, 0 to 210
Data columns (total 7 columns):
 #   Column       Non-Null Count  Dtype         
---  ------       --------------  -----         
 0   fecha        211 non-null    datetime64[ns]
 1   fabricacion  211 non-null    int64         
 2   est          211 non-null    float64       
 3   mg           211 non-null    float64       
 4   ph           211 non-null    float64       
 5   cloruros     211 non-null    float64       
 6   coliformes   210 non-null    float64       
dtypes: datetime64[ns](1), float64(5), int64(1)
memory usage: 11.7 KB</code></pre>
</div>
</div>
<p>Ahora la fecha tiene formato <code>datetime64</code> que es el formato de fecha que reconoce <code>pandas</code>.</p>
</section>
<section id="ordenarlimpiar-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="ordenarlimpiar-los-datos">2. Ordenar/limpiar los datos</h3>
<p>La tabla de datos que hemos leído ya está en un formato <em>tidy</em>: una línea por observación y una columna por medida, como comprobamos inspeccionando las primera lineas de código:</p>
<div id="cell-19" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fecha</th>
<th data-quarto-table-cell-role="th">fabricacion</th>
<th data-quarto-table-cell-role="th">est</th>
<th data-quarto-table-cell-role="th">mg</th>
<th data-quarto-table-cell-role="th">ph</th>
<th data-quarto-table-cell-role="th">cloruros</th>
<th data-quarto-table-cell-role="th">coliformes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2020-01-11</td>
<td>1</td>
<td>46.68</td>
<td>24.0</td>
<td>4.85</td>
<td>1.50</td>
<td>80.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2020-01-12</td>
<td>1</td>
<td>48.09</td>
<td>25.0</td>
<td>4.67</td>
<td>1.61</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2020-01-13</td>
<td>1</td>
<td>45.97</td>
<td>24.0</td>
<td>4.71</td>
<td>1.48</td>
<td>9200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2020-01-14</td>
<td>1</td>
<td>46.24</td>
<td>23.5</td>
<td>4.78</td>
<td>1.69</td>
<td>20.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020-01-15</td>
<td>1</td>
<td>45.81</td>
<td>23.0</td>
<td>4.77</td>
<td>1.56</td>
<td>150.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Vamos entonces a verificar que los valores que hemos leído son correctos. ¿Qué tenemos que buscar?</p>
<ul>
<li>Valores mal introducidos que <code>Python</code>no tiene por qué saber que son erróneos (por ejemplo, un pH de 51,5 en vez de 5,15)</li>
<li>Valores anormalmente altos o bajos, que pueden indicar errores de medida, de toma de muestras o de introducción de datos (por ejemplo, un pH de leche de 30, que puede indicar una lectura de temperatura introducida fuera de sitio)</li>
<li>Valores erróneos: por ejemplo, valores negativos en cualquier medida</li>
<li>Una distribucion de los datos anormal:
<ul>
<li>por ejemplo, el pH de un queso debería tener la mayor frecuencia entorno al pH objetivo, y desviaciones con una frecuencia cada vez más baja a medida que se alejan del valor central</li>
<li>en cambio, los recuentos de bacterias coliformes deberían tener la mayor frecuencia en los valores cero o muy bajos, y la distribución no debería ser simétrica</li>
</ul></li>
</ul>
<p>En general, cualquier cosa que nos llame la atención en los datos y que debemos explicar.</p>
<p>Para hacer esta verificación, analizamos cada variable (columna) por separado.</p>
</section>
<section id="visualizar-análisis-gráfico" class="level3">
<h3 class="anchored" data-anchor-id="visualizar-análisis-gráfico">3. Visualizar: Análisis gráfico</h3>
<p>Comenzamos el análisis estudiando la variable o columna <code>est</code>, que almacena los valores de <strong>extracto seco total</strong>. Utilizamos las herramientas gráficas que conocemos: <strong>histograma</strong> y <strong>diagrama de caja</strong>. Por el momento no nos preocupamos de rotular el gráfico, estamos simplemente explorando de forma rápida.</p>
<section id="el-histograma" class="level4">
<h4 class="anchored" data-anchor-id="el-histograma">El histograma</h4>
<div id="cell-22" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">"est"</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>También podemos utilizar <code>seaborn</code>, que nos permite incluir la curva de densidad de forma muy sencilla.</p>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;elapsed&quot;:573,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1759679749575,&quot;user&quot;:{&quot;displayName&quot;:&quot;Juan Riera&quot;,&quot;userId&quot;:&quot;13936244033390161607&quot;},&quot;user_tz&quot;:-120}}" data-outputid="1c993f1c-c3b3-4a42-c8f7-81200c5484bd" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sns.displot(df[<span class="st">"est"</span>], kde <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>El histograma nos muestra la mayor frecuencia en torno a los valores centrales, la distribución es aproximadamente simétrica, y parece tener algún valor anormalmente alto (52). ¿Debería preocuparnos este valor? ¿Es razonable o puede ser un error?</p>
<p>La curva de densidad muestra algo que debe resultarnos sospechoso: hay una subida en torno a 52. Una curva de distribución que fuese semejante a una <strong>campana de Gauss</strong> (distribución <em>normal</em>) no debería mostrar uncambio en sus extremos, sino amortiguarse suavemente hasta cero.</p>
<p>Continuamos explorando con el <em>boxplot</em>.</p>
</section>
<section id="el-boxplot" class="level4">
<h4 class="anchored" data-anchor-id="el-boxplot">El <em>boxplot</em></h4>
<div id="cell-28" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;elapsed&quot;:125,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1759679750829,&quot;user&quot;:{&quot;displayName&quot;:&quot;Juan Riera&quot;,&quot;userId&quot;:&quot;13936244033390161607&quot;},&quot;user_tz&quot;:-120}}" data-outputid="e812e45b-0e6a-46ab-f98e-c39033402041" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(df[<span class="st">'est'</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>El <em>boxplot</em> nos indica que no sólo el valor ligeramente por encima de 52 parece anormal, también lo parecen algunos valores por encima de 50.</p>
</section>
<section id="los-gráficos-de-series-temporales" class="level4">
<h4 class="anchored" data-anchor-id="los-gráficos-de-series-temporales">Los gráficos de <em>series temporales</em></h4>
<p>Ya sabemos que paree haber algún valor atípico, anormalmente alto, en nuestros datos. ¿Cómo podemos profundizar un poco más y decidir si debemos excluir estos valores analíticos?</p>
<p>Sabemos que estos resultados se han obtenido a lo largo de un año. ¿Puede haber pasado algo en algún momento que haya hecho que algunos resultados se hayan desviado? Veamos cuál ha sido la evolución anual del extracto seco total de nuestra fabricación, descrito por la columna o variable <code>est</code>.</p>
<div id="cell-32" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'est'</span>].plot()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico representa los valores individuales de manera secuencial, y el eje X muestra el número de orden del valor. Sería mucho más útil si este eje estuviera rotulado con fechas. <code>Seaborn</code> puede ayudarnos con esto.</p>
<div id="cell-34" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span> df, x<span class="op">=</span><span class="st">'fecha'</span>, y<span class="op">=</span><span class="st">'est'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plt.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Como hemos convertido la columna <code>fecha</code> a un formato de fecha, <code>seaborn</code>la reconoce y rotula el eje correctamente.</p>
<p>Los valores anormales se han producido en el verano, en torno a julio-agosto. En esta época ha habido una subida de los valores de extracto seco total. A la vista del gráfico, los valores por encima de 50, aunque extremos, parece que están dentro de un momento en el que el extracto seco se había desviado hacia arriba. Esto sitúa a esos valores en un contexto temporal en el que probablemente puede que no fueran tan anormales. ¿Qué quiere decir esto? Pues que si un valor de 52 es <em>atípico</em> frente al conjunto de datos completo, es posible que no lo sea si los valores que lo rodean también lo eran y se consideran sólo esos valores de contexto.</p>
<p>Vamos a explorar esto un poco más y mostrar los datos por meses, para ver si considerados mes a mes, el valor de 52 sigue pareciendo anormal, y vamos a utilizar también <code>pandas</code>para hacer los gráficos de series.</p>
</section>
<section id="el-boxplot-por-categorías" class="level4">
<h4 class="anchored" data-anchor-id="el-boxplot-por-categorías">El <em>boxplot</em> por categorías</h4>
<p>Para representar los datos por mes con <code>pandas</code>, tenemos que crear una columna índice con la fecha:</p>
<div id="cell-39" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fecha_index'</span>]<span class="op">=</span> pd.DatetimeIndex(df.fecha).normalize()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df.set_index(<span class="st">'fecha_index'</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df.sort_index(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La función <code>.normalize()</code> elimina de los campos de fecha/tiempo la parte referida a minutos y segundos, aquí se ha usado como ejemplo, porque nuestras fechas no tienen ese nivel de detalle.</p>
<div id="cell-41" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
DatetimeIndex: 211 entries, 2020-01-11 to 2020-12-29
Data columns (total 7 columns):
 #   Column       Non-Null Count  Dtype         
---  ------       --------------  -----         
 0   fecha        211 non-null    datetime64[ns]
 1   fabricacion  211 non-null    int64         
 2   est          211 non-null    float64       
 3   mg           211 non-null    float64       
 4   ph           211 non-null    float64       
 5   cloruros     211 non-null    float64       
 6   coliformes   210 non-null    float64       
dtypes: datetime64[ns](1), float64(5), int64(1)
memory usage: 13.2 KB</code></pre>
</div>
</div>
<p>AUnque el índice <code>fecha_index</code> que hemos creado, que tiene tipo <code>DateTimeIndex</code>, no aparece entre las columnas, sí está reseñado en el encabezado de la descripción, y muestra que existen 211 entradas desde el 11/1/2020 hasta el 29/12/2020. Usamos este índice para crear una columna con el mes, usando una de las muchas funciones de <code>pandas</code> asociadas a una columna de fecha. En este caso, <code>.month()</code> extrae el mes en formato numérico:</p>
<div id="cell-43" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mes'</span>] <span class="op">=</span> df.index.month</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veamos la columna en nuestro <em>DataFrame</em>:</p>
<div id="cell-45" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fecha</th>
<th data-quarto-table-cell-role="th">fabricacion</th>
<th data-quarto-table-cell-role="th">est</th>
<th data-quarto-table-cell-role="th">mg</th>
<th data-quarto-table-cell-role="th">ph</th>
<th data-quarto-table-cell-role="th">cloruros</th>
<th data-quarto-table-cell-role="th">coliformes</th>
<th data-quarto-table-cell-role="th">mes</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">fecha_index</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020-01-11</td>
<td>2020-01-11</td>
<td>1</td>
<td>46.68</td>
<td>24.0</td>
<td>4.85</td>
<td>1.50</td>
<td>80.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020-01-12</td>
<td>2020-01-12</td>
<td>1</td>
<td>48.09</td>
<td>25.0</td>
<td>4.67</td>
<td>1.61</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020-01-13</td>
<td>2020-01-13</td>
<td>1</td>
<td>45.97</td>
<td>24.0</td>
<td>4.71</td>
<td>1.48</td>
<td>9200.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020-01-14</td>
<td>2020-01-14</td>
<td>1</td>
<td>46.24</td>
<td>23.5</td>
<td>4.78</td>
<td>1.69</td>
<td>20.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020-01-15</td>
<td>2020-01-15</td>
<td>1</td>
<td>45.81</td>
<td>23.0</td>
<td>4.77</td>
<td>1.56</td>
<td>150.0</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Ahora podemos agrupar nuestros valores por meses, y comprobar los valores anormales <em>dentro de cada mes</em>. Para ello, simplemente indicamos a <code>seaborn</code> la variable que va a estar en el eje X:</p>
<div id="cell-47" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;elapsed&quot;:209,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1759679752296,&quot;user&quot;:{&quot;displayName&quot;:&quot;Juan Riera&quot;,&quot;userId&quot;:&quot;13936244033390161607&quot;},&quot;user_tz&quot;:-120}}" data-outputid="f5df808b-cfa4-4c19-fc4a-e200ea8c679d" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'mes'</span>, y<span class="op">=</span><span class="st">'est'</span>, data<span class="op">=</span>df)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En vez de usar el número para el mes, podemos usar el código de letras abreviado. En este caso, <code>seaborn</code>utiliza la abreviatura en inglés , pero podríamos cambiar la codificación para que lo represente en español con la instruccion <code>locale</code> (queda como ejercicio personal explorar el uso y opciones de esta instrucción).</p>
<p>Aprovechamos para personalizar un poco el gráfico, y mostramos cómo pueden añadirse diferentes opciones de formato; cuando <code>Python</code> encuentra opciones de formato, el gráfico no se mostrará hasta que ejecutemos la instrucción <code>.show()</code></p>
<div id="cell-49" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;elapsed&quot;:279,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1759679753775,&quot;user&quot;:{&quot;displayName&quot;:&quot;Juan Riera&quot;,&quot;userId&quot;:&quot;13936244033390161607&quot;},&quot;user_tz&quot;:-120}}" data-outputid="377f646b-d39c-4fc8-f655-399e8c080bd7" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mes_abreviado'</span>] <span class="op">=</span> df.index.strftime(<span class="st">'%b'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'mes_abreviado'</span>, y<span class="op">=</span><span class="st">'est'</span>, data<span class="op">=</span>df)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Opcional: Personalizar el gráfico</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Boxplot de la variable "est" por Mes'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Mes'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Valor de "est"'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.grid(axis<span class="op">=</span><span class="st">'y'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>) <span class="co"># Añadir una cuadrícula para mejor lectura</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>) <span class="co"># Rotar las etiquetas del eje X si son muchas</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout() <span class="co"># Ajusta automáticamente los parámetros de la subtrama para un diseño ajustado</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>¡Ahora nuestra visión de los datos ha cambiado! Resulta que los valores anaíticos de extracto seco han ido variando a lo largo del año, y el valor supuestamente anómalo de 52 ya no lo es considerando los datos mes a mes, porque <em>todos lo valores de julio</em> han sido muy altos, y 52 no parece extremo en este contexto. En cambio, vemos que en mayo sí ha habido valores anómalos en relación a los obtenidos en el mes. ¿Deben preocuparnos estos valores de mayo? Probablemente no, porque están dentro del conjunto de los valores anuales; sin embargo, es conveniente profundizar en la razón por la que la dispersión de los valores de mayo, mostrada por el rango intercuartil, es muy baja, y sin embargo en junio ha aumentado mucho. Los valores de julio sí parecen excesivamente altos casi durante todo el mes, la mediana de los valores ha sido la más alta del año.</p>
<p>Detallemos un poco más, viendo los valores semanales:</p>
<div id="cell-51" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"est"</span>].resample(<span class="st">'W-MON'</span>).mean().plot(title<span class="op">=</span><span class="st">"Media del extracto seco total semanal"</span>)<span class="op">;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Hagamos un zoom en los valores de abril a agosto utilizando las opciones de filtro de fechas de <code>pandas</code>:</p>
<div id="cell-53" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"est"</span>][<span class="st">"2020-04"</span>:<span class="st">"2020-08"</span>].resample(<span class="st">'W-MON'</span>).mean().plot(title<span class="op">=</span><span class="st">"Media del extracto seco total semanal"</span>)<span class="op">;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Efectivamente, las semanas de julio han tenido valores crecientes de extracto seco, y esto no se ha corregido hasta el mes de agosto. En realidad, a partir de octubre se ha bajado el extracto seco de nuevo a valores más cercanos a los del primer semestre.</p>
<p>La opción de filtro de fecha puede aplicarse también a las funciones de <code>seaborn</code>, veamos un ejemplo que muestra con claridad el aumento de extracto seco en julio frente a los meses anteriores.</p>
<div id="cell-56" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mes_abreviado'</span>] <span class="op">=</span> df.index.strftime(<span class="st">'%b'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'mes_abreviado'</span>, y<span class="op">=</span><span class="st">'est'</span>, data<span class="op">=</span>df[<span class="st">"2020-04"</span>:<span class="st">"2020-08"</span>])</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Opcional: Personalizar el gráfico</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Boxplot de la variable "est" por Mes'</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Mes'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Valor de "est"'</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.grid(axis<span class="op">=</span><span class="st">'y'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>) <span class="co"># Añadir una cuadrícula para mejor lectura</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>) <span class="co"># Rotar las etiquetas del eje X si son muchas</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout() <span class="co"># Ajusta automáticamente los parámetros de la subtrama para un diseño ajustado</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>De manera visual, podemos aceptar que, en general, cuando la caja del boxplot se sitúa claramente por encima o por debajo de la caja de otro boxplot, las diferencias entre los dos conjuntos de valores son significativas; en este caso, podemos afirmar con claridad que los extractos secos de julio han sido significativamente superiores a los de los meses anteriores.</p>
<p>Antes de pensar en posibles causas de esta desviación, vamos a hacer el mismo análisis en la materia grasa, y después estableceremos una hipótesis de trabajo que explique esta desviación. Este es un punto importante del análisis en el que hay que insistir:</p>
<blockquote class="blockquote">
<p>Nunca conviene precipitar el establecimiento de hipótesis sobre las causas de un problema, es imprescindible completar el proceso de análisis de los elementos que tengamos anuestra disposición, sin perjuicio de que nuevos ciclos de análisis, transformación y visualización nos permitan seguir profundizando</p>
</blockquote>
<div id="cell-59" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sns.displot(df[<span class="st">"mg"</span>], kde <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'mes'</span>, y<span class="op">=</span><span class="st">'mg'</span>, data<span class="op">=</span>df)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>También en la materia grasa hay valores anormales, el único que parece fuera de contexto es el valor anormal de enero.</p>
</section>
<section id="el-gráfico-de-dispersión" class="level4">
<h4 class="anchored" data-anchor-id="el-gráfico-de-dispersión">El gráfico de dispersión</h4>
<p>En general, cuando en una fabricación de queso aumenta el extracto seco, lo más común es que aumente también la materia grasa, que forma parte de ese extracto seco. ¿Cómo han variado la <code>mg</code> y el <code>est</code>durante el perído que estamos considerando? Veámoslo con un diagrama de dispersión:</p>
<div id="cell-64" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'est'</span>, y<span class="op">=</span><span class="st">'mg'</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>Seaborn</code> Nos permite incluir una zona de confianza o <em>intervalo de confianza</em> para los valores que varían conjuntamente; utilizaremos la curva equivalente a la función de densidad que veíamos en el histograma:</p>
<div id="cell-66" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'est'</span>, y<span class="op">=</span><span class="st">'mg'</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'est'</span>, y<span class="op">=</span><span class="st">'mg'</span>, levels<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'r'</span>, linewidths<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>Seaborn</code> tiene un gráfico muy interesante que nos permite ver ambas variables en un gráfico conjunto, que nos muestra histogramas y un diagrama de dispersión.</p>
<div id="cell-68" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;elapsed&quot;:340,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1759679764304,&quot;user&quot;:{&quot;displayName&quot;:&quot;Juan Riera&quot;,&quot;userId&quot;:&quot;13936244033390161607&quot;},&quot;user_tz&quot;:-120}}" data-outputid="b4c2e6fc-b83a-460b-f059-6f92f9c9b7bc" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sns.jointplot(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"est"</span>, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"mg"</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En estos dos gráficos, vemos que hay tres valores que podríamos considerar al menos como sospechosos:</p>
<ol type="1">
<li>El valor 52 de extracto seco total</li>
<li>El valor 28 de materia grasa</li>
<li>Un valor que los <em>boxplot</em> no nos habían detectado, por debajo de 22 de <code>mg</code> y por encima de 48 de <code>est</code>, lo que resulta anormal dentro de la composición habitual del queso.</li>
</ol>
<p>El dibujo de la zona de confianza del gráfico de dispersión nos facilita el análisis de lo que debemos considerar anómalo y lo que no lo es; es muy útil para el análisis de variables que están relacionadas y que pueden (o deben) cambiar sus valores de forma conjunta.</p>
</section>
<section id="completando-el-análisis" class="level4">
<h4 class="anchored" data-anchor-id="completando-el-análisis">Completando el análisis</h4>
<p>Antes de pasar al análisis y conclusiones, veamos dos gráficos complementarios de los anteriores, que muestran simultáneamente la media y la desviación típica semanales del extracto seco y la materia grasa,</p>
<div id="cell-72" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Preparación de los datos (Calculando la Media y la Desviación Típica Semanal) ---</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>media_semanal <span class="op">=</span> df[<span class="st">"est"</span>].resample(<span class="st">'W-MON'</span>).mean()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>dt_semanal <span class="op">=</span> df[<span class="st">"est"</span>].resample(<span class="st">'W-MON'</span>).std()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Creación de los Subgráficos (El paso clave) ---</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una figura (conjunto de gráficos) con 2 filas y 1 columna.</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># El parámetro 'figsize=(10, 4)' controla el tamaño: 10 de ancho y 4 de alto total (como un gráfico normal).</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 'sharex=True' asegura que ambos gráficos compartan el mismo eje temporal.</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    nrows<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    ncols<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>), </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    sharex<span class="op">=</span><span class="va">True</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Graficar la Media (Gráfico Superior) ---</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>ax1.plot(media_semanal, label<span class="op">=</span><span class="st">"Media Semanal"</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">"Media y Desviación Típica Semanal del Extracto Seco Total"</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">"Media (est)"</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(labelbottom<span class="op">=</span><span class="va">False</span>) <span class="co"># Quita las etiquetas de fecha/hora del gráfico superior</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Graficar la Desviación Típica (Gráfico Inferior) ---</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>ax2.plot(dt_semanal, label<span class="op">=</span><span class="st">"Desviación Típica Semanal"</span>, color<span class="op">=</span><span class="st">'tab:orange'</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">"D. Típica (est)"</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajusta el espacio entre los gráficos para que no se superpongan</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>fig.tight_layout() </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-73" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Preparación de los datos (Calculando la Media y la Desviación Típica Semanal) ---</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>media_semanal <span class="op">=</span> df[<span class="st">"mg"</span>].resample(<span class="st">'W-MON'</span>).mean()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dt_semanal <span class="op">=</span> df[<span class="st">"mg"</span>].resample(<span class="st">'W-MON'</span>).std()</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Creación de los Subgráficos (El paso clave) ---</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una figura (conjunto de gráficos) con 2 filas y 1 columna.</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># El parámetro 'figsize=(10, 4)' controla el tamaño: 10 de ancho y 4 de alto total (como un gráfico normal).</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 'sharex=True' asegura que ambos gráficos compartan el mismo eje temporal.</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    nrows<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    ncols<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>), </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    sharex<span class="op">=</span><span class="va">True</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Graficar la Media (Gráfico Superior) ---</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>ax1.plot(media_semanal, label<span class="op">=</span><span class="st">"Media Semanal"</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">"Media y Desviación Típica Semanal de la materia grasa"</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">"Media (mg)"</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(labelbottom<span class="op">=</span><span class="va">False</span>) <span class="co"># Quita las etiquetas de fecha/hora del gráfico superior</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Graficar la Desviación Típica (Gráfico Inferior) ---</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>ax2.plot(dt_semanal, label<span class="op">=</span><span class="st">"Desviación Típica Semanal"</span>, color<span class="op">=</span><span class="st">'tab:orange'</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">"D. Típica (mg)"</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajusta el espacio entre los gráficos para que no se superpongan</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>fig.tight_layout() </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Como tecnólogos queseros, sabemos que un factor crítico de la textura del queso, y en consecuencia, de su calidad, es la humedad del extracto seco desnatado, que calculamos a partir del extracto seco y la materia grasa como:</p>
<p><span class="math display">\[
\text{hqd} = \frac{(100 - \text{est\%})}{(100 - \text{mg\%})} \times 100
\]</span></p>
<p>Vamos a hacer un último gráfico, de la <code>hqd</code>, para completar nuestro análisis, creando una nueva columna en el <code>DataFrame</code>:</p>
<div id="cell-75" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'hqd'</span>] <span class="op">=</span> ((<span class="dv">100</span> <span class="op">-</span> df[<span class="st">'est'</span>]) <span class="op">/</span> (<span class="dv">100</span> <span class="op">-</span> df[<span class="st">'mg'</span>])) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Preparación de los datos (Calculando la Media y la Desviación Típica Semanal) ---</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>media_semanal <span class="op">=</span> df[<span class="st">"hqd"</span>].resample(<span class="st">'W-MON'</span>).mean()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>dt_semanal <span class="op">=</span> df[<span class="st">"hqd"</span>].resample(<span class="st">'W-MON'</span>).std()</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Creación de los Subgráficos (El paso clave) ---</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una figura (conjunto de gráficos) con 2 filas y 1 columna.</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># El parámetro 'figsize=(10, 4)' controla el tamaño: 10 de ancho y 4 de alto total (como un gráfico normal).</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 'sharex=True' asegura que ambos gráficos compartan el mismo eje temporal.</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    nrows<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    ncols<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>), </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    sharex<span class="op">=</span><span class="va">True</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Graficar la Media (Gráfico Superior) ---</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>ax1.plot(media_semanal, label<span class="op">=</span><span class="st">"Media Semanal"</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">"Media y Desviación Típica Semanal de la humedad del queso desnatado"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">"Media (hqd)"</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(labelbottom<span class="op">=</span><span class="va">False</span>) <span class="co"># Quita las etiquetas de fecha/hora del gráfico superior</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Graficar la Desviación Típica (Gráfico Inferior) ---</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>ax2.plot(dt_semanal, label<span class="op">=</span><span class="st">"Desviación Típica Semanal"</span>, color<span class="op">=</span><span class="st">'tab:orange'</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">"D. Típica (hqd)"</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajusta el espacio entre los gráficos para que no se superpongan</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>fig.tight_layout() </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="080-caso1-camembert_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análisis-de-los-resultados" class="level4">
<h4 class="anchored" data-anchor-id="análisis-de-los-resultados">Análisis de los resultados</h4>
<p>Una vez explorados los datos, siempre tenemos que formular hipótesis de trabajo para entender lo que nos dicen, y estudiar estas hipótesis con detalle hasta encontrar una explicación razonable. De estas conclusiones se deducirá una toma de decisiones para la mejora del proceso, que puede continuar con nuevos análisis e hipótesis.</p>
<p>A la vista de las series de datos, podemos establecer varias hipótesis:</p>
<ol type="1">
<li>A principio de año ha habido una cantidad de materia grasa anormalmente alta en el queso, que puede haberse debido a un error en la estandarización. De hecho, la composición de la leche en esta época es más rica en MG que el resto del año, lo que puede haber llevado a este error. Sin embargo esto no ha sido un problema porque también el extracto seco ha sido un poco más alto, seguramente debido a una correción del trabajo en la cuba. Como resultado, el responsable de fabricación ha mantenido la <code>hqd</code> constante en torno a 71% hasta el mes de mayo.</li>
<li>A partir de febrero, se ha intentado corregir la estandarización aumentando la <code>mg</code> de forma constante hasta el verano.</li>
<li>En mayo se ha mantenido la composición en <code>mg</code>, pero se ha subido el <code>est</code>, lo que ha llevado a una reducción de <code>hqd</code>.</li>
<li>En verano se han obtenido valores de extracto seco muy altos que han producido una bajada brusca en <code>hqd</code> de hasta casi 7 puntos hasta un valor de 65%, lo que es un gran problema para la textura de un queso camembert.</li>
<li>Además de esto, los tres valores anómalos que encontramos en el análisis del <code>jointplot</code> probablemente sean errores analíticos o de toma de muestras, ya que no se corresponden con el resto de los valores. ¿Sería más seguro eliminarlos del análisis?</li>
</ol>
</section>
</section>
<section id="comunicar-discusión-de-la-información-en-equipo." class="level3">
<h3 class="anchored" data-anchor-id="comunicar-discusión-de-la-información-en-equipo.">4. Comunicar: discusión de la información en equipo.</h3>
<p>Hemos ido a una reunión de trabajo con la quesera responsable de fabricación del queso, con el analista de laboratorio y con el responsable de producción, que es el que da las instrucciones para la modificación de la tecnología. Después de la discusión, hemos obtenido las siguientes conclusiones.</p>
<ul>
<li>Debido a las variaciones de composición, el responsable de fabricación nos confirma que, efectivamente, a lo largo del año hace pequeñas modificaciones en la estandarización y el trabajo en cuba, buscando mantener constante la <code>hqd</code>.</li>
<li>El mayor consumo del queso camembert de este fabricante tiene lugar en las zonas costeras del sur y en Canarias, zonas en las que el queso es muy apreciado por los turistas que vienen a España. En verano, debido a que las temperaturas son más altas, suele bajar moderadamente la <code>hqd</code> para evitar problemas de proteoisis excesiva durante el ciclo de comercialización.</li>
<li>Este año ha habido un problema adicional en el verano, y es que, durante las vacaciones, el quesero ha sido sustituido por una persona con menos experiencia, que ha forzado el extracto seco más de lo debido; también ha habido reclamaciones de consumidores por queso demasiado seco, lo que coincide con lo observado en los análisis.</li>
<li>El laboratorio ha confirmado que los valores anómalos sospechosos pueden haber sido debidos a análisis incorrectos, y recomienda no tenerlos en cuenta. En consecuencia, deberíamos repetir el análisis gráfico eliminando estos valores, para que las conclusiones no se vean afectadas por ellos.</li>
</ul>
<section id="posible-plan-de-trabajo" class="level4">
<h4 class="anchored" data-anchor-id="posible-plan-de-trabajo">Posible plan de trabajo</h4>
<p>A la vista de estos resultados, el equipo propone las siguentes acciones:</p>
<ol type="1">
<li>Revisar diariamente la composición de la leche para evitar errores de estandarización.</li>
<li>Mejorar la formación a las personas que son responsables de la toma de muestras para evitar errores.</li>
<li>Repasar los métodos analíticos con los analistas del laboratorio y posiblemente poner en marcha un estudio sobre la precisión de los análisis, incluyendo la dispersión por analista.</li>
<li>Actualizar con agilidad la información sobre la situación del queso en el punto de venta, con el fin de asegurar la calidad, evitando una sobrecorrección de la <code>hqd</code> en los meses de verano. Valorar si los problemas de proteolisis en el punto de venta durante estos meses de verano son generales o sólo se presentan en algunos clientes.</li>
<li>Cuidar las sustituciones en verano en los puntos críticos: quesero y analistas, para no introducir variabilidad por defectos de formación en las personas sustitutas.</li>
<li>Anticipar los ciclos de formación a las personas encargadas de sustituir puntos clave en situaciones de enfermedad o vacaciones, mejorando la polivalencia.</li>
</ol>
<p>Dado que la capacidad de poner planes de ación del equipo es limitada, debido a la carga de trabajo de producción, en sucesivas reuniones se priorizarán los planes de acción que tengan mayor impacto en la calidad y en el coste del producto, y se establecerán calendarios de trabajo e indicadores que reflejen los impactos de las acciones en marcha. Estos indicadores se publicarán semanalmente en paneles situados en la planta, para que el equipo pueda verlos y discutirlos.</p>
</section>
</section>
</section>
<section id="resumen-del-capítulo" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="resumen-del-capítulo"><span class="header-section-number">8.2</span> Resumen del capítulo</h2>
<p>En este capítulo hemos analizado una fabricación anual de queso camembert y hemos aprendido a detectar posibles errores en los atos, así como a interpretar lo sucedido durante una temporada de fabricación, sacando conclusiones para establecer planes de mejora.</p>
<p>En el capítulo siguiente nos enfrentaremos al análisis de las entradas de leche en una gran fábrica de queso.</p>
</section>
<section id="ejercicios-propuestos" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="ejercicios-propuestos"><span class="header-section-number">8.3</span> Ejercicios propuestos</h2>
<section id="ejercicio-1" class="level3">
<h3 class="anchored" data-anchor-id="ejercicio-1">Ejercicio 1</h3>
<p>En el análisis de resultados, encontramos tres valores anormales de <code>est</code>y <code>mg</code>, y concluimos que deberíamos repetir el análisis sin estos valores.</p>
<p>Utilizando el filtro de Excel, busca los tres valores y elimínalos del <code>camembert.csv</code>. Guarda el archivo editado como <code>camembert_corregido.csv</code>. Modifica las instrucciones de lectura de datos del cuaderno para leer este nuevo archivo y repite el análisis. ¿Llegas a las mismas conclusiones? Elabora un nuevo informe de conclusiones y prepara un PowerPoint para presentarlo al grupo. Puedes incluso usar los resultados del primer análisis y compararlos lado a lado con los del segundo.</p>
<p>Podrás comprobar que los scripts <code>python</code> nos permiten repetir el análisis sin ninguna modificación (salvo el nombre del archivo de datos) en escasos minutos, y que rápidamente podemos usar los resultados para escribir un informe.</p>
<p>Como sugerencia, puedes copiar los gráficos en cualquier otro programa (por ejemplo, en PowerPoint) simplemente copiando el gráfico del cuaderno y pegándolo donde quieras. Es un sistema manual pero muy flexible y suficientemente rápido.</p>
</section>
<section id="ejercicio-2-avanzado" class="level3">
<h3 class="anchored" data-anchor-id="ejercicio-2-avanzado">Ejercicio 2 (avanzado)</h3>
<p>En este ejercicio, vamos a añadir la fase <strong>Transformar</strong> a nuestro flujo de datos en <code>Python</code>.</p>
<p>En vez de editar el <code>csv</code> para modificar los datos, vamos a utilizar <code>Python</code>para hacer un filtro de los datos anómalos, y nos vamos a apoyar en Gemini o en ChatGPT para escribir el código.</p>
<p>Abre Gemini y haz esta pregunta:</p>
<blockquote class="blockquote">
<p>Tengo un dataframe <code>df</code> con dos columnas, <code>est</code>y <code>mg</code>. Quiero filtrar algunos valores y convertirlos en ‘NaN’: los valores con <code>mg</code>mayor que 27, los valores con <code>est</code> mayor que 52 y los valores que sean simultáneamente con <code>mg</code> menor que 22 y <code>est</code>mayor que 48. Dame el código python para hacerlo de la manera más sencilla posible.</p>
</blockquote>
<p>Copia la respuesta de Gemini e insértala en una casilla de código al final de este mismo cuaderno, después del último texto.</p>
<p>Ahora vete copiando y pegando a continuación las casillas de código del análisis que hemos realizado y que quieras repetir para verificar el filtrado de datos:</p>
<ul>
<li>el histograma</li>
<li>el boxplot general</li>
<li>el boxplot por meses</li>
<li>el gráfico de dispersión</li>
<li>el gráfico de series</li>
</ul>
<p>Comprueba si las conclusiones que hemos hecho se mantienen o hay que modificarlas, y escribe las nuevas conclusiones si crees necesario modificarlas. Establece un plan de trabajo acorde con estas conclusiones y prepara un PowerPoint para comunicar al equipo el resultado del análisis y el nuevo plan de acción.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./070-estad-simple.html" class="pagination-link" aria-label="Medidas centrales y medidas de dispersión: la media y la varianza.">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Medidas centrales y medidas de dispersión: la media y la varianza.</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./090-indice_dataframes.html" class="pagination-link" aria-label="Indice de DataFrames utilizados">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Indice de DataFrames utilizados</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>